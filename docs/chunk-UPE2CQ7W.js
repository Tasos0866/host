import{a as j}from"./chunk-E2JE6NOM.js";import"./chunk-BGGO3X4J.js";import{a as Q}from"./chunk-GL3AGNQ6.js";import{a as K}from"./chunk-X3FAMIGX.js";import{a as F,b as E}from"./chunk-NEN62UNH.js";import{c as x,d as O,e as B,f as V,g as H,h as R,i as k,j as D,k as N,l as L,m as q,o as J,p as z,q as G}from"./chunk-H7QKMAAS.js";import"./chunk-65CRZK2F.js";import{Ab as g,Bb as h,Cb as S,Db as v,Ea as t,Eb as b,Ib as r,Ja as _,Jb as o,Kb as M,Pa as A,S as T,Za as d,a as y,eb as n,ec as I,fb as a,gb as C,mb as c,pc as W,qb as w,yb as l,zb as u}from"./chunk-RDUCI247.js";var P=class f{motorCostTable=[{widthRange:[0,600],armRange:[0,250],motorCost:250},{widthRange:[0,600],armRange:[275,350],motorCost:400},{widthRange:[0,600],armRange:[375,500],motorCost:650},{widthRange:[601,1e3],armRange:[0,250],motorCost:400},{widthRange:[601,1e3],armRange:[275,350],motorCost:400},{widthRange:[601,1e3],armRange:[375,500],motorCost:650},{widthRange:[1001,1500],armRange:[0,250],motorCost:650},{widthRange:[1001,1500],armRange:[275,350],motorCost:650},{widthRange:[1001,1500],armRange:[375,500],motorCost:1200}];getMotorCost(i,p){for(let e of this.motorCostTable){let[s,m]=e.widthRange,[X,Y]=e.armRange;if(i>=s&&i<=m&&p>=X&&p<=Y)return e.motorCost}return 0}static \u0275fac=function(p){return new(p||f)};static \u0275prov=T({token:f,factory:f.\u0275fac,providedIn:"root"})};var U=class f{constructor(i,p,e){this.sunAwningsPriceService=i;this.armDetailsService=p;this.motorPriceService=e;i.hasData()?this.initializeView():i.loadPricesFromSheet().subscribe(()=>{this.initializeView()})}minWidthValue=200;maxWidthValue=1500;minHeightValue=160;maxHeightValue=500;width=this.minWidthValue;height=this.minHeightValue;fabricPricePerSquareMeter=0;fabricNameList=[];totalPrice=null;totalPriceWithTax=null;tax=null;squareMeters=0;fabricPrices={};numberOfArms=0;folded=0;extended=0;type="";armPrice=0;isCounterWeightSelected=!1;selectedCounterweightType="";counterWeightPrices={};motorCost=0;isAluminiumCoverSelected=!1;aluminiumCoverPrice=null;isAirSensorSelected=!1;selectedAirSensorType="shockproof";windsockPrice=0;shockproofPrice=0;selectedPaintOption="white";motorSelected;initializeView(){this.motorSelected=!1,this.updateAirSensorPrices(),this.updateMaxHeight(),this.updateFolded(),this.updateNumberOfArms(),this.updateType(),this.updateExtended(),this.updateMotorCost(),this.initializeFabricField(),this.updateCounterWeightPrices(),this.calculateTotalPrice()}initializeFabricField(){this.fabricNameList=this.sunAwningsPriceService.getFabricNameList("fabrics_folding_arms"),this.fabricPrices=this.sunAwningsPriceService.getFabricPrices("fabrics_folding_arms")}updateAirSensorPrices(){this.windsockPrice=this.sunAwningsPriceService.getExtraInfo("windsock"),this.shockproofPrice=this.sunAwningsPriceService.getExtraInfo("shockproof")}clampValue(i,p,e){return Math.min(Math.max(i,p),e)}setDefaultCounterweightType(){this.valuesOutOfRange()||(this.width<=700&&this.extended<=350?this.selectedCounterweightType="Jumbo":this.width>700&&this.extended>350?this.selectedCounterweightType="Hercules":this.selectedCounterweightType="Standard")}handleWidthChange(i,p){this.width=this.clampValue(i,this.minWidthValue,this.maxWidthValue),p.value=String(this.width),this.updateMaxHeight(),this.height>this.maxHeightValue&&(this.height=this.maxHeightValue,p.value=String(this.height)),this.updateCounterWeightPrices()}handleHeightChange(i,p){this.height=this.clampValue(i,this.minHeightValue,this.maxHeightValue),p.value=String(this.height)}onBlur(i,p){let e=i.target;if(!e)return;let s=Number(e.value);p==="width"?this.handleWidthChange(s,e):p==="height"&&this.handleHeightChange(s,e),this.updateFolded(),this.updateNumberOfArms(),this.updateType(),this.updateExtended(),this.updateMotorCost(),this.calculateTotalPrice()}updateFabricPrice(i){i&&(this.fabricPricePerSquareMeter=i,this.calculateTotalPrice())}onMotorChange(i){this.motorSelected=i,this.resetAirSensorField(),this.calculateTotalPrice()}updateMotorCost(){if(this.valuesOutOfRange()){this.motorCost=0;return}this.motorCost=this.motorPriceService.getMotorCost(this.width,this.extended)}updateMaxHeight(){let i=this.armDetailsService.getMaxHeight(this.width);i!==null&&(this.maxHeightValue=i)}updateType(){let i=this.armDetailsService.getTypeByFolded(this.folded);this.type=i!==null?i:""}updateExtended(){let i=this.armDetailsService.getExtendedByFolded(this.folded);this.extended=i!==null?i:0,this.setDefaultCounterweightType()}updateNumberOfArms(){let i=this.armDetailsService.getNumberOfArms(this.width,this.folded);this.numberOfArms=i!==null?i:0}updateFolded(){let i=this.armDetailsService.findFoldedByHeight(this.height);this.folded=i!==null?i:0}updateCounterWeightPrices(){if(this.valuesOutOfRange()){this.counterWeightPrices={};return}let i=this.sunAwningsPriceService.getCounterweightPrices();this.counterWeightPrices=y({},i);for(let p in this.counterWeightPrices)Object.prototype.hasOwnProperty.call(this.counterWeightPrices,p)&&(this.counterWeightPrices[p]=Math.floor(this.counterWeightPrices[p]*this.width/100))}calculateTotalPrice(){if(this.valuesOutOfRange()){this.aluminiumCoverPrice=null,this.totalPrice=null,this.totalPriceWithTax=null,this.tax=null;return}let i=this.sunAwningsPriceService.getExtraInfo("VAT")/100,p=this.width>600?this.sunAwningsPriceService.getExtraInfo("heavy_duty_base"):0,e=this.counterWeightPrices?.[this.selectedCounterweightType]||0,s=this.sunAwningsPriceService.getExtraInfo(this.selectedAirSensorType)||0;this.armPrice=this.armDetailsService.getPrice(this.extended)||0,this.aluminiumCoverPrice=Math.floor(this.sunAwningsPriceService.getExtraInfo("aluminium_cover")*(this.width/100));let m=this.selectedPaintOption==="other"?1.2:1;this.squareMeters=(this.width+10)*(this.height+70)/1e4,this.totalPrice=Math.floor(this.squareMeters*this.fabricPricePerSquareMeter+this.numberOfArms*this.armPrice*m+(this.motorSelected?this.motorCost:0)+(this.isAluminiumCoverSelected?this.aluminiumCoverPrice:0)+(this.isCounterWeightSelected?e*m:0)+p+(this.isAirSensorSelected?s:0)),this.tax=Math.floor(this.totalPrice*i),this.totalPriceWithTax=Math.floor(this.totalPrice+this.tax)}valuesOutOfRange(){return this.width<this.minWidthValue||this.width>this.maxWidthValue||this.height<this.minHeightValue||this.height>this.maxHeightValue}onAluminiumCoverToggle(i){this.isAluminiumCoverSelected=i,this.calculateTotalPrice()}onCounterWeightToggle(i){this.isCounterWeightSelected=i,this.calculateTotalPrice()}onAirSensorToggle(i){this.isAirSensorSelected=i,this.calculateTotalPrice()}toggleAirSensorType(i){this.selectedAirSensorType=i,this.calculateTotalPrice()}onCounterweightTypeChange(i){this.selectedCounterweightType=i,this.calculateTotalPrice()}onPaintOptionChange(i){this.selectedPaintOption=i,this.calculateTotalPrice()}resetAirSensorField(){this.motorSelected||(this.isAirSensorSelected=!1)}static \u0275fac=function(p){return new(p||f)(_(E),_(F),_(P))};static \u0275cmp=A({type:f,selectors:[["app-folding-arms"]],decls:111,vars:153,consts:[[1,"folding-arms","product-container"],[1,"awning-title"],[1,"desktop-layout"],[1,"svg-width"],["src","assets/img/sun-awnings/folding.webp","alt","Awning with folding arms illustration",1,"awning-image"],[1,"form-fields"],[1,"awning-title-desktop"],[1,"dimensions-title"],[1,"dimensions-fields"],["appearance","outline",1,"width-field"],["matInput","","type","number",3,"ngModelChange","blur","ngModel","min","max"],["appearance","outline"],[1,"extra-fields"],["appearance","outline",1,"field","left-field","m2-field"],["readonly","","matInput","","type","text",3,"value"],["appearance","outline",1,"arms-field","field"],[3,"updateFabricPrice","fabricNameList","fabricPrices"],["aria-label","Counterweight selection","matTooltipPosition","above","matTooltipClass","tooltip",1,"counterweight-field",3,"hideSingleSelectionIndicator","matTooltip"],[3,"selectionChange","selected","selectable"],["aria-label","Counterweight type",1,"field",3,"ngModelChange","hideSingleSelectionIndicator","disabled","ngModel"],["value","Standard",3,"selectionChange","selected","selectable"],["value","Jumbo",3,"selectionChange","selected","selectable"],["value","Hercules",3,"selectionChange","selected","selectable"],[3,"updateMotorState","motorCost"],["aria-label","Air sensor selection",1,"air-sensor-field",3,"disabled","hideSingleSelectionIndicator"],["aria-label","Air sensor type",1,"field",3,"hideSingleSelectionIndicator","disabled"],["aria-label","Aluminium cover selection","matTooltipPosition","above",1,"field",3,"hideSingleSelectionIndicator","matTooltip"],["aria-label","Paint options",1,"field",3,"hideSingleSelectionIndicator"],[3,"totalPriceWithTax","totalPrice","tax"]],template:function(p,e){p&1&&(n(0,"div",0)(1,"h1",1),l(2),r(3,"translate"),a(),n(4,"div",2)(5,"div",3),C(6,"img",4),a(),n(7,"div",5)(8,"h1",6),l(9),r(10,"translate"),a(),n(11,"h4",7),l(12),r(13,"translate"),a(),n(14,"div",8)(15,"mat-form-field",9)(16,"mat-label"),l(17),r(18,"translate"),a(),n(19,"input",10),b("ngModelChange",function(m){return v(e.width,m)||(e.width=m),m}),c("ngModelChange",function(){return e.updateMaxHeight(),e.updateFolded(),e.updateNumberOfArms(),e.updateType(),e.updateExtended(),e.updateMotorCost(),e.updateCounterWeightPrices(),e.calculateTotalPrice()})("blur",function(m){return e.onBlur(m,"width")}),a(),n(20,"mat-hint"),l(21),a()(),n(22,"mat-form-field",11)(23,"mat-label"),l(24),r(25,"translate"),a(),n(26,"input",10),b("ngModelChange",function(m){return v(e.height,m)||(e.height=m),m}),c("ngModelChange",function(){return e.updateMaxHeight(),e.updateFolded(),e.updateNumberOfArms(),e.updateType(),e.updateExtended(),e.updateMotorCost(),e.calculateTotalPrice()})("blur",function(m){return e.onBlur(m,"height")}),a(),n(27,"mat-hint"),l(28),a()()(),n(29,"div",12)(30,"mat-form-field",13)(31,"mat-label"),l(32),r(33,"translate"),a(),C(34,"input",14),r(35,"number"),a(),n(36,"mat-form-field",15)(37,"mat-label"),l(38),r(39,"translate"),r(40,"translate"),a(),C(41,"input",14),a()(),n(42,"h4"),l(43),r(44,"translate"),r(45,"translate"),a(),n(46,"app-fabric-selection",16),c("updateFabricPrice",function(m){return e.updateFabricPrice(m)}),a(),n(47,"h4"),l(48),r(49,"translate"),a(),n(50,"mat-chip-listbox",17),r(51,"translate"),n(52,"mat-chip-option",18),c("selectionChange",function(){return e.onCounterWeightToggle(!1)}),l(53),r(54,"translate"),a(),n(55,"mat-chip-option",18),c("selectionChange",function(){return e.onCounterWeightToggle(!0)}),l(56),r(57,"translate"),a()(),n(58,"mat-chip-listbox",19),b("ngModelChange",function(m){return v(e.selectedCounterweightType,m)||(e.selectedCounterweightType=m),m}),n(59,"mat-chip-option",20),c("selectionChange",function(){return e.onCounterweightTypeChange("Standard")}),l(60),r(61,"translate"),a(),n(62,"mat-chip-option",21),c("selectionChange",function(){return e.onCounterweightTypeChange("Jumbo")}),l(63),r(64,"translate"),a(),n(65,"mat-chip-option",22),c("selectionChange",function(){return e.onCounterweightTypeChange("Hercules")}),l(66),r(67,"translate"),a()(),n(68,"h4"),l(69),r(70,"translate"),a(),n(71,"app-motor-selection",23),c("updateMotorState",function(m){return e.onMotorChange(m)}),a(),n(72,"h4"),l(73),r(74,"translate"),a(),n(75,"mat-chip-listbox",24)(76,"mat-chip-option",18),c("selectionChange",function(){return e.onAirSensorToggle(!1)}),l(77),r(78,"translate"),a(),n(79,"mat-chip-option",18),c("selectionChange",function(){return e.onAirSensorToggle(!0)}),l(80),r(81,"translate"),a()(),n(82,"mat-chip-listbox",25)(83,"mat-chip-option",18),c("selectionChange",function(){return e.toggleAirSensorType("shockproof")}),l(84),r(85,"translate"),a(),n(86,"mat-chip-option",18),c("selectionChange",function(){return e.toggleAirSensorType("windsock")}),l(87),r(88,"translate"),a()(),n(89,"h4"),l(90),r(91,"translate"),a(),n(92,"mat-chip-listbox",26),r(93,"translate"),n(94,"mat-chip-option",18),c("selectionChange",function(){return e.onAluminiumCoverToggle(!1)}),l(95),r(96,"translate"),a(),n(97,"mat-chip-option",18),c("selectionChange",function(){return e.onAluminiumCoverToggle(!0)}),l(98),r(99,"translate"),a()(),n(100,"h4"),l(101),r(102,"translate"),a(),n(103,"mat-chip-listbox",27)(104,"mat-chip-option",18),c("selectionChange",function(){return e.onPaintOptionChange("white")}),l(105),r(106,"translate"),a(),n(107,"mat-chip-option",18),c("selectionChange",function(){return e.onPaintOptionChange("other")}),l(108),r(109,"translate"),a()(),C(110,"app-total-price-card",28),a()()()),p&2&&(t(2),u(o(3,90,"folding_arms_title")),t(7),u(o(10,92,"folding_arms_title")),t(3),u(o(13,94,"dimensions")),t(5),g("",o(18,96,"width")," (cm)"),t(2),S("ngModel",e.width),d("min",e.minWidthValue)("max",e.maxWidthValue),t(2),h("Min: ",e.minWidthValue," cm, Max: ",e.maxWidthValue," cm"),t(3),g("",o(25,98,"height")," (cm)"),t(2),S("ngModel",e.height),d("min",e.minHeightValue)("max",e.maxHeightValue),t(2),h("Min: ",e.minHeightValue," cm, Max: ",e.maxHeightValue," cm"),t(4),u(o(33,100,"fabric_m2")),t(2),d("value",M(35,102,e.squareMeters,"1.2-2")),t(4),h(" ",o(39,105,"quantity")," \xD7 ",o(40,107,"arm_type")," "),t(3),d("value",e.numberOfArms+"  \xD7  "+e.type+" ("+e.armPrice*e.numberOfArms+"\u20AC)"),t(2),h("",o(44,109,"fabric")," (",o(45,111,"price_per_m2"),")"),t(3),d("fabricNameList",e.fabricNameList)("fabricPrices",e.fabricPrices),t(2),u(o(49,113,"aluminum_counterweight")),t(2),w("matTooltip",o(51,115,"counterweight_tooltip_text")),d("hideSingleSelectionIndicator",!0),t(2),d("selected",!e.isCounterWeightSelected)("selectable",e.isCounterWeightSelected),t(),g(" ",o(54,117,"no_counterweight")," "),t(2),d("selected",e.isCounterWeightSelected)("selectable",!e.isCounterWeightSelected),t(),g(" ",o(57,119,"aluminum_counterweight")," "),t(2),d("hideSingleSelectionIndicator",!0)("disabled",!e.isCounterWeightSelected),S("ngModel",e.selectedCounterweightType),t(),d("selected",e.selectedCounterweightType==="Standard")("selectable",e.selectedCounterweightType!=="Standard"),t(),h(" ",o(61,121,"counterweight.Standard")," (",e.counterWeightPrices.Standard,"\u20AC) "),t(2),d("selected",e.selectedCounterweightType==="Jumbo")("selectable",e.selectedCounterweightType!=="Jumbo"),t(),h(" ",o(64,123,"counterweight.Jumbo")," (",e.counterWeightPrices.Jumbo,"\u20AC) "),t(2),d("selected",e.selectedCounterweightType==="Hercules")("selectable",e.selectedCounterweightType!=="Hercules"),t(),h(" ",o(67,125,"counterweight.Hercules")," (",e.counterWeightPrices.Hercules,"\u20AC) "),t(3),u(o(70,127,"electric_motor")),t(2),d("motorCost",e.motorCost),t(2),u(o(74,129,"air_sensor")),t(2),d("disabled",!e.motorSelected)("hideSingleSelectionIndicator",!0),t(),d("selected",!e.isAirSensorSelected)("selectable",e.isAirSensorSelected),t(),g(" ",o(78,131,"no_air_sensor")," "),t(2),d("selected",e.isAirSensorSelected)("selectable",!e.isAirSensorSelected),t(),g(" ",o(81,133,"air_sensor")," "),t(2),d("hideSingleSelectionIndicator",!0)("disabled",!e.isAirSensorSelected),t(),d("selected",e.selectedAirSensorType==="shockproof")("selectable",e.selectedAirSensorType!=="shockproof"),t(),h(" ",o(85,135,"shockproof")," (",e.shockproofPrice,"\u20AC) "),t(2),d("selected",e.selectedAirSensorType==="windsock")("selectable",e.selectedAirSensorType!=="windsock"),t(),h(" ",o(88,137,"windsock")," (",e.windsockPrice,"\u20AC) "),t(3),u(o(91,139,"aluminium_cover")),t(2),w("matTooltip",o(93,141,"aluminium_cover_tooltip")),d("hideSingleSelectionIndicator",!0),t(2),d("selected",!e.isAluminiumCoverSelected)("selectable",e.isAluminiumCoverSelected),t(),g(" ",o(96,143,"no_aluminium_cover")," "),t(2),d("selected",e.isAluminiumCoverSelected)("selectable",!e.isAluminiumCoverSelected),t(),h(" ",o(99,145,"aluminium_cover")," (",e.aluminiumCoverPrice,"\u20AC) "),t(3),u(o(102,147,"component_painting")),t(2),d("hideSingleSelectionIndicator",!0),t(),d("selected",e.selectedPaintOption==="white")("selectable",e.selectedPaintOption!=="white"),t(),g(" ",o(106,149,"paint.white")," "),t(2),d("selected",e.selectedPaintOption==="other")("selectable",e.selectedPaintOption!=="other"),t(),g(" ",o(109,151,"paint.other")," "),t(2),d("totalPriceWithTax",e.totalPriceWithTax)("totalPrice",e.totalPrice)("tax",e.tax))},dependencies:[L,D,q,k,x,V,O,R,H,B,N,j,J,I,W,K,Q,G,z],styles:[".windows[_ngcontent-%COMP%]{min-width:320px;margin-top:24px;min-height:90%}.m2-field[_ngcontent-%COMP%], .arms-field[_ngcontent-%COMP%]{align-self:start}.extra-fields[_ngcontent-%COMP%]{display:flex;justify-content:start;width:100%}.counterweight-field[_ngcontent-%COMP%], .air-sensor-field[_ngcontent-%COMP%]{margin-bottom:4px}@media (max-width: 535px){.m2-field[_ngcontent-%COMP%], .arms-field[_ngcontent-%COMP%]{width:100%}.extra-fields[_ngcontent-%COMP%]{flex-direction:column}}"]})};export{U as FoldingArmsComponent};

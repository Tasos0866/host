import{a as q}from"./chunk-5NBIUBQX.js";import{a as D}from"./chunk-PPYRUKHS.js";import{b as x}from"./chunk-CDRVJPGK.js";import{c as y,d as T,e as E,f as W,g as I,h as F,i as H,j as B,k as L,l as N,m as A,o as O}from"./chunk-7HRNV44S.js";import"./chunk-CJA2TO4M.js";import{Ab as p,Bb as f,Cb as g,Db as v,Eb as b,Fa as n,Fb as _,Jb as s,Ka as P,Kb as h,Lb as w,Qa as M,_a as c,fb as r,fc as S,gb as a,hb as d,nb as u,qc as V,zb as o}from"./chunk-W6CIVE6P.js";var z=class C{constructor(t){this.sunAwningsPriceService=t;t.hasData()?this.initializeView():t.loadPricesFromSheet().subscribe(()=>{this.initializeView()})}minWidthValue=150;maxWidthValue=1500;minHeightValue=150;maxHeightValue=500;width=this.minWidthValue;height=this.minHeightValue;fabricPricePerSquareMeter=0;fabricNameList=[];totalPrice=null;totalPriceWithTax=null;tax=null;squareMeters=0;fabricPrices={};motorCost=0;motorSelected;initializeView(){this.motorSelected=!1,this.updateMotorCost(),this.initializeFabricField(),this.calculateTotalPrice()}initializeFabricField(){this.fabricNameList=this.sunAwningsPriceService.getFabricNameList("fabrics_vertical"),this.fabricPrices=this.sunAwningsPriceService.getFabricPrices("fabrics_vertical")}clampValue(t,i,e){return Math.min(Math.max(t,i),e)}handleWidthChange(t,i){this.width=this.clampValue(t,this.minWidthValue,this.maxWidthValue),i.value=String(this.width)}handleHeightChange(t,i){this.height=this.clampValue(t,this.minHeightValue,this.maxHeightValue),i.value=String(this.height)}calculateHeavyDutySupportCharge(){return this.width>600?this.motorSelected?this.sunAwningsPriceService.getExtraInfo("heavy_duty_base_motor"):this.sunAwningsPriceService.getExtraInfo("heavy_duty_base"):0}minimumCostCheck(t){let i=this.squareMeters*t;return i<200?200:i}updateFabricPrice(t){t&&(this.fabricPricePerSquareMeter=t,this.calculateTotalPrice())}onMotorChange(t){this.motorSelected=t,this.calculateTotalPrice()}onBlur(t,i){let e=t.target;if(!e)return;let m=Number(e.value);i==="width"?this.handleWidthChange(m,e):i==="height"&&this.handleHeightChange(m,e),this.updateMotorCost(),this.calculateTotalPrice()}updateMotorCost(){if(this.valuesOutOfRange()){this.motorCost=0;return}this.motorCost=this.sunAwningsPriceService.getExtraInfo(this.width>600?"motor_od_large":"motor_od_small")}calculateTotalPrice(){if(this.valuesOutOfRange()){this.totalPrice=null,this.totalPriceWithTax=null,this.tax=null;return}let t=this.sunAwningsPriceService.getExtraInfo("VAT")/100,i=this.calculateHeavyDutySupportCharge();this.squareMeters=(this.width+10)*(this.height+70)/1e4;let e=this.minimumCostCheck(this.fabricPricePerSquareMeter);this.totalPrice=Math.floor(e+(this.motorSelected?this.motorCost:0)+i),this.tax=Math.floor(this.totalPrice*t),this.totalPriceWithTax=Math.floor(this.totalPrice+this.tax)}valuesOutOfRange(){return this.width<this.minWidthValue||this.width>this.maxWidthValue||this.height<this.minHeightValue||this.height>this.maxHeightValue}static \u0275fac=function(i){return new(i||C)(P(x))};static \u0275cmp=M({type:C,selectors:[["app-vertical"]],decls:45,vars:47,consts:[["xmlns","http://www.w3.org/1999/html",1,"vertical","product-container"],[1,"awning-title"],[1,"desktop-layout"],[1,"svg-width"],["src","assets/img/sun-awnings/vertical.webp","alt","Vertical awning illustration",1,"awning-image"],[1,"form-fields"],[1,"awning-title-desktop"],[1,"dimensions-title"],[1,"dimensions-fields"],["appearance","outline",1,"width-field"],["matInput","","type","number",3,"ngModelChange","blur","ngModel","min","max"],["appearance","outline"],["appearance","outline",1,"field","left-field","m2-field"],["readonly","","matInput","","type","text",3,"value"],[3,"updateFabricPrice","fabricNameList","fabricPrices"],[3,"updateMotorState","motorCost"],[3,"totalPriceWithTax","totalPrice","tax"]],template:function(i,e){i&1&&(r(0,"div",0)(1,"h1",1),o(2),s(3,"translate"),a(),r(4,"div",2)(5,"div",3),d(6,"img",4),a(),r(7,"div",5)(8,"h1",6),o(9),s(10,"translate"),a(),r(11,"h4",7),o(12),s(13,"translate"),a(),r(14,"div",8)(15,"mat-form-field",9)(16,"mat-label"),o(17),s(18,"translate"),a(),r(19,"input",10),_("ngModelChange",function(l){return b(e.width,l)||(e.width=l),l}),u("ngModelChange",function(){return e.updateMotorCost(),e.calculateTotalPrice()})("blur",function(l){return e.onBlur(l,"width")}),a(),r(20,"mat-hint"),o(21),a()(),r(22,"mat-form-field",11)(23,"mat-label"),o(24),s(25,"translate"),a(),r(26,"input",10),_("ngModelChange",function(l){return b(e.height,l)||(e.height=l),l}),u("ngModelChange",function(){return e.updateMotorCost(),e.calculateTotalPrice()})("blur",function(l){return e.onBlur(l,"height")}),a(),r(27,"mat-hint"),o(28),a()()(),r(29,"mat-form-field",12)(30,"mat-label"),o(31),s(32,"translate"),a(),d(33,"input",13),s(34,"number"),a(),r(35,"h4"),o(36),s(37,"translate"),s(38,"translate"),a(),r(39,"app-fabric-selection",14),u("updateFabricPrice",function(l){return e.updateFabricPrice(l)}),a(),r(40,"h4"),o(41),s(42,"translate"),a(),r(43,"app-motor-selection",15),u("updateMotorState",function(l){return e.onMotorChange(l)}),a(),d(44,"app-total-price-card",16),a()()()),i&2&&(n(2),p(h(3,26,"vertical_title")),n(7),p(h(10,28,"vertical_title")),n(3),p(h(13,30,"dimensions")),n(5),f("",h(18,32,"width")," (cm)"),n(2),v("ngModel",e.width),c("min",e.minWidthValue)("max",e.maxWidthValue),n(2),g("Min: ",e.minWidthValue," cm, Max: ",e.maxWidthValue," cm"),n(3),f("",h(25,34,"height")," (cm)"),n(2),v("ngModel",e.height),c("min",e.minHeightValue)("max",e.maxHeightValue),n(2),g("Min: ",e.minHeightValue," cm, Max: ",e.maxHeightValue," cm"),n(3),p(h(32,36,"fabric_m2")),n(2),c("value",w(34,38,e.squareMeters,"1.2-2")),n(3),g("",h(37,41,"fabric")," (",h(38,43,"price_per_m2"),")"),n(3),c("fabricNameList",e.fabricNameList)("fabricPrices",e.fabricPrices),n(2),p(h(42,45,"electric_motor")),n(2),c("motorCost",e.motorCost),n(),c("totalPriceWithTax",e.totalPriceWithTax)("totalPrice",e.totalPrice)("tax",e.tax))},dependencies:[N,B,A,H,y,W,T,F,I,E,L,O,S,V,D,q],styles:[".vertical[_ngcontent-%COMP%]{min-width:320px;margin-top:24px;min-height:90%}mat-radio-button[_ngcontent-%COMP%]:first-child{margin-right:8px}.m2-field[_ngcontent-%COMP%]{align-self:start}@media (max-width: 535px){.m2-field[_ngcontent-%COMP%]{width:100%}}"]})};export{z as VerticalComponent};

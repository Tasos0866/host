import{a as O}from"./chunk-PPYRUKHS.js";import{b as S}from"./chunk-CDRVJPGK.js";import{c as F,d as T,e as W,f as y,g as E,h as I,i as B,j as H,k as N,l as L,m as A,o as q}from"./chunk-7HRNV44S.js";import"./chunk-CJA2TO4M.js";import{Ab as p,Bb as f,Cb as g,Db as b,Eb as P,Fa as t,Fb as _,Jb as o,Ka as v,Kb as h,Lb as C,Qa as w,_a as c,fb as a,fc as V,gb as i,hb as u,nb as d,qc as x,zb as l}from"./chunk-W6CIVE6P.js";var D=class M{constructor(n){this.sunAwningsPriceService=n;n.hasData()?this.initializeView():n.loadPricesFromSheet().subscribe(()=>{this.initializeView()})}minWidthValue=150;maxWidthValue=1500;minHeightValue=150;maxHeightValue=500;width=this.minWidthValue;height=this.minHeightValue;fabricNameList=[];totalPrice=null;totalPriceWithTax=null;tax=null;squareMeters=0;fabricPrices={};fabricPricePerSquareMeter=0;initializeView(){this.fabricNameList=this.sunAwningsPriceService.getFabricNameList("fabrics_change"),this.fabricPrices=this.sunAwningsPriceService.getFabricPrices("fabrics_change"),this.calculateTotalPrice()}clampValue(n,m,e){return Math.min(Math.max(n,m),e)}updateFabricPrice(n){n&&(this.fabricPricePerSquareMeter=n,this.calculateTotalPrice())}calculateTotalPrice(){if(this.valuesOutOfRange()){this.totalPrice=null,this.totalPriceWithTax=null,this.tax=null;return}let n=this.sunAwningsPriceService.getExtraInfo("VAT")/100;this.squareMeters=(this.width+10)*(this.height+70)/1e4,this.totalPrice=Math.floor(this.squareMeters*this.fabricPricePerSquareMeter),this.tax=Math.floor(this.totalPrice*n),this.totalPriceWithTax=Math.floor(this.totalPrice+this.tax)}valuesOutOfRange(){return this.width<this.minWidthValue||this.width>this.maxWidthValue||this.height<this.minHeightValue||this.height>this.maxHeightValue}onBlur(n,m){let e=n.target;if(!e)return;let s=Number(e.value);m==="width"?(this.width=this.clampValue(s,this.minWidthValue,this.maxWidthValue),e.value=String(this.width)):m==="height"&&(this.height=this.clampValue(s,this.minHeightValue,this.maxHeightValue),e.value=String(this.height)),this.calculateTotalPrice()}static \u0275fac=function(m){return new(m||M)(v(S))};static \u0275cmp=w({type:M,selectors:[["app-fabric-change"]],decls:41,vars:43,consts:[[1,"fabric-change","product-container"],[1,"awning-title"],[1,"desktop-layout"],[1,"svg-width"],["src","assets/img/sun-awnings/fabric-change.webp","alt","Fabric change illustration",1,"awning-image"],[1,"form-fields"],[1,"awning-title-desktop"],[1,"dimensions-title"],[1,"dimensions-fields"],["appearance","outline",1,"width-field"],["matInput","","type","number",3,"ngModelChange","blur","ngModel","min","max"],["appearance","outline"],["appearance","outline",1,"field","left-field","m2-field"],["readonly","","matInput","","type","text",3,"value"],[3,"updateFabricPrice","fabricNameList","fabricPrices"],[3,"totalPriceWithTax","totalPrice","tax"]],template:function(m,e){m&1&&(a(0,"div",0)(1,"h1",1),l(2),o(3,"translate"),i(),a(4,"div",2)(5,"div",3),u(6,"img",4),i(),a(7,"div",5)(8,"h1",6),l(9),o(10,"translate"),i(),a(11,"h4",7),l(12),o(13,"translate"),i(),a(14,"div",8)(15,"mat-form-field",9)(16,"mat-label"),l(17),o(18,"translate"),i(),a(19,"input",10),_("ngModelChange",function(r){return P(e.width,r)||(e.width=r),r}),d("ngModelChange",function(){return e.calculateTotalPrice()})("blur",function(r){return e.onBlur(r,"width")}),i(),a(20,"mat-hint"),l(21),i()(),a(22,"mat-form-field",11)(23,"mat-label"),l(24),o(25,"translate"),i(),a(26,"input",10),_("ngModelChange",function(r){return P(e.height,r)||(e.height=r),r}),d("ngModelChange",function(){return e.calculateTotalPrice()})("blur",function(r){return e.onBlur(r,"height")}),i(),a(27,"mat-hint"),l(28),i()()(),a(29,"mat-form-field",12)(30,"mat-label"),l(31),o(32,"translate"),i(),u(33,"input",13),o(34,"number"),i(),a(35,"h4"),l(36),o(37,"translate"),o(38,"translate"),i(),a(39,"app-fabric-selection",14),d("updateFabricPrice",function(r){return e.updateFabricPrice(r)}),i(),u(40,"app-total-price-card",15),i()()()),m&2&&(t(2),p(h(3,24,"fabric_change_title")),t(7),p(h(10,26,"fabric_change_title")),t(3),p(h(13,28,"dimensions")),t(5),f("",h(18,30,"width")," (cm)"),t(2),b("ngModel",e.width),c("min",e.minWidthValue)("max",e.maxWidthValue),t(2),g("Min: ",e.minWidthValue," cm, Max: ",e.maxWidthValue," cm"),t(3),f("",h(25,32,"height")," (cm)"),t(2),b("ngModel",e.height),c("min",e.minHeightValue)("max",e.maxHeightValue),t(2),g("Min: ",e.minHeightValue," cm, Max: ",e.maxHeightValue," cm"),t(3),p(h(32,34,"fabric_m2")),t(2),c("value",C(34,36,e.squareMeters,"1.2-2")),t(3),g("",h(37,39,"fabric")," (",h(38,41,"price_per_m2"),")"),t(3),c("fabricNameList",e.fabricNameList)("fabricPrices",e.fabricPrices),t(),c("totalPriceWithTax",e.totalPriceWithTax)("totalPrice",e.totalPrice)("tax",e.tax))},dependencies:[L,H,A,B,F,y,T,I,E,W,N,q,V,x,O],styles:[".fabric-change[_ngcontent-%COMP%]{min-width:320px;margin-top:24px;min-height:90%}.m2-field[_ngcontent-%COMP%]{align-self:start}@media (max-width: 535px){.m2-field[_ngcontent-%COMP%]{width:100%}}"]})};export{D as FabricChangeComponent};

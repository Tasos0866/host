import{a as j,b as x,c as V,d as G,e as q,f as J}from"./chunk-4Z4RIYRB.js";import"./chunk-Q7C7OCQL.js";import{a as y}from"./chunk-CDH7M54U.js";import{c as w,d as W,e as I,f as E,g as B,h as F,i as H,j as D,k,l as O,m as N,o as R,p as z,q as A}from"./chunk-7HRNV44S.js";import{w as L}from"./chunk-CJA2TO4M.js";import{Ab as d,Bb as P,Cb as m,Db as v,Eb as f,Fa as i,Fb as _,Jb as p,Ka as u,Kb as h,Pb as T,Qa as b,_a as c,fb as r,gb as a,hb as C,nb as g,qc as M,zb as s}from"./chunk-W6CIVE6P.js";var K=class S{constructor(t,o,e,n){this.pergolaPricesService=t;this.changeDetector=o;this.snackBar=e;this.translate=n;this.pergolaPricesService.hasData()?(this.setMinMaxValues(),this.initializeDimensions(),this.initializeGeneralTable(),this.updatePrices()):this.pergolaPricesService.loadPricesFromSheet().subscribe(()=>{this.setMinMaxValues(),this.initializeDimensions(),this.initializeGeneralTable(),this.updatePrices()})}minWidthValue=0;maxWidthValue=0;minProjectionValue=0;maxProjectionValue=0;width=0;projection=0;pergolaColorsList=j;fabricColorsList=x;lightsEnabled=!1;selectedLightsType="no";coverPrice=null;standardLightsPrice=null;luxLightsPrice=null;pergolaPrice=null;totalPrice=null;totalPriceWithTax=null;isCoverSelected=!1;isOtherPergolaColorSelected=!1;generalTable={};tax=null;selectedPergolaColor="anthracite_7016";selectedFabricColor="#d5d4af";imageSource="assets/img/hanging pergolas/anthracite_7016.svg";setMinMaxValues(){let t="Hanging";this.minWidthValue=this.pergolaPricesService.getMinWidth(t),this.maxWidthValue=this.pergolaPricesService.getMaxWidth(t),this.minProjectionValue=this.pergolaPricesService.getMinProjection(t),this.maxProjectionValue=this.pergolaPricesService.getMaxProjection(t)}initializeDimensions(){this.width=this.minWidthValue,this.projection=this.minProjectionValue}updatePrices(){this.updateCoverPrice(),this.updateStandardLightsPrice(),this.updateLuxLightsPrice(),this.updatePergolaPrice(),this.calculateTotalPrice()}updatePergolaPrice(){let o=this.pergolaPricesService.getPrice("Hanging",this.projection,this.width);this.pergolaPrice=o!==null?o:null,this.isOtherPergolaColorSelected&&this.pergolaPrice!==null&&(this.pergolaPrice=Math.floor(this.pergolaPrice*1.1))}updateCoverPrice(){this.width&&this.projection&&(this.coverPrice=this.pergolaPricesService.getPrice("Cover",this.projection,this.width),this.isOtherPergolaColorSelected&&this.coverPrice!==null&&(this.coverPrice=Math.floor(this.coverPrice*1.1)),this.changeDetector.markForCheck())}updateStandardLightsPrice(){this.width&&this.projection&&(this.standardLightsPrice=this.pergolaPricesService.getPrice("Lights_Standard",this.projection,this.width),this.changeDetector.markForCheck())}updateLuxLightsPrice(){this.width&&this.projection&&(this.luxLightsPrice=this.pergolaPricesService.getPrice("Lights_Lux",this.projection,this.width),this.changeDetector.markForCheck())}valuesOutOfRange(){return this.width<this.minWidthValue||this.width>this.maxWidthValue||this.projection<this.minProjectionValue||this.projection>this.maxProjectionValue}calculateTotalPrice(){if(this.valuesOutOfRange()){this.totalPrice=null,this.totalPriceWithTax=null,this.tax=null;return}let t=this.isCoverSelected?this.coverPrice??0:0,o=this.generalTable.VAT/100;this.totalPrice=(this.pergolaPrice??0)+t+(this.lightsEnabled?(this.selectedLightsType==="lux"?this.luxLightsPrice:this.standardLightsPrice)??0:0),this.tax=Math.floor(this.totalPrice*o),this.totalPriceWithTax=this.totalPrice+this.tax,this.changeDetector.markForCheck()}initializeGeneralTable(){this.generalTable=this.pergolaPricesService.getGeneralTable()}onLightsToggle(t){this.selectedLightsType=t,this.lightsEnabled=t!=="no",this.updatePrices()}onBlur(t,o){let e=t.target;if(!e)return;let n=Number(e.value);o==="width"?(n<this.minWidthValue?e.value=String(this.minWidthValue):n>this.maxWidthValue&&(e.value=String(this.maxWidthValue)),this.width=Number(e.value)):o==="projection"&&(n<this.minProjectionValue?e.value=String(this.minProjectionValue):n>this.maxProjectionValue&&(e.value=String(this.maxProjectionValue)),this.projection=Number(e.value)),this.updatePrices()}onFabricColorChange(t){let o=this.fabricColorsList.find(e=>e.value===t.value);this.selectedFabricColor=o?.colorCode||"#d5d4af"}onPergolaColorChange(t){if(this.selectedPergolaColor=t.value,this.isOtherPergolaColorSelected=this.selectedPergolaColor==="other",this.imageSource=`assets/img/hanging pergolas/${this.selectedPergolaColor}.svg`,this.isOtherPergolaColorSelected){let o=this.translate.instant("other_pergola_color_message"),e=this.translate.instant("close");this.snackBar.open(o,e,{duration:8e3})}this.updatePrices()}onCoverToggle(t){this.isCoverSelected=t==="yes",this.calculateTotalPrice()}static \u0275fac=function(o){return new(o||S)(u(y),u(T),u(J),u(L))};static \u0275cmp=b({type:S,selectors:[["app-hanging-pergola"]],decls:55,vars:70,consts:[[1,"hanging-pergola","product-container"],[1,"awning-title"],[1,"desktop-layout"],[1,"svg-width"],[3,"svgPath","fabricColor"],[1,"form-fields"],[1,"awning-title-desktop"],[1,"dimensions-title"],[1,"dimensions-fields"],["appearance","outline",1,"width-field"],["matInput","","type","number",3,"ngModelChange","blur","ngModel","min","max"],["appearance","outline"],[3,"fabricColorChange","fabricColorsList","selectedFabricColor"],[3,"pergolaColorChange","pergolaColorsList","selectedPergolaColor"],["aria-label","Lights selection",1,"field",3,"hideSingleSelectionIndicator"],[3,"selectionChange","selected","selectable"],["aria-label","Cover selection",1,"field",3,"hideSingleSelectionIndicator"],[3,"totalPriceWithTax","totalPrice","tax"]],template:function(o,e){o&1&&(r(0,"div",0)(1,"h1",1),s(2),p(3,"translate"),a(),r(4,"div",2)(5,"div",3),C(6,"app-svg-viewer",4),a(),r(7,"div",5)(8,"h1",6),s(9),p(10,"translate"),a(),r(11,"h4",7),s(12),p(13,"translate"),a(),r(14,"div",8)(15,"mat-form-field",9)(16,"mat-label"),s(17),p(18,"translate"),a(),r(19,"input",10),_("ngModelChange",function(l){return f(e.width,l)||(e.width=l),l}),g("ngModelChange",function(){return e.updatePrices()})("blur",function(l){return e.onBlur(l,"width")}),a(),r(20,"mat-hint"),s(21),a()(),r(22,"mat-form-field",11)(23,"mat-label"),s(24),p(25,"translate"),a(),r(26,"input",10),_("ngModelChange",function(l){return f(e.projection,l)||(e.projection=l),l}),g("ngModelChange",function(){return e.updatePrices()})("blur",function(l){return e.onBlur(l,"projection")}),a(),r(27,"mat-hint"),s(28),a()()(),r(29,"app-fabric-color-chips",12),g("fabricColorChange",function(l){return e.onFabricColorChange(l)}),a(),r(30,"app-pergola-color-chips",13),g("pergolaColorChange",function(l){return e.onPergolaColorChange(l)}),a(),r(31,"h4"),s(32),p(33,"translate"),a(),r(34,"mat-chip-listbox",14)(35,"mat-chip-option",15),g("selectionChange",function(){return e.onLightsToggle("no")}),s(36),p(37,"translate"),a(),r(38,"mat-chip-option",15),g("selectionChange",function(){return e.onLightsToggle("standard")}),s(39),p(40,"translate"),a(),r(41,"mat-chip-option",15),g("selectionChange",function(){return e.onLightsToggle("lux")}),s(42),p(43,"translate"),a()(),r(44,"h4"),s(45),p(46,"translate"),a(),r(47,"mat-chip-listbox",16)(48,"mat-chip-option",15),g("selectionChange",function(){return e.onCoverToggle("no")}),s(49),p(50,"translate"),a(),r(51,"mat-chip-option",15),g("selectionChange",function(){return e.onCoverToggle("yes")}),s(52),p(53,"translate"),a()(),C(54,"app-total-price-card",17),a()()()),o&2&&(i(2),d(h(3,46,"hanging_pergola")),i(4),c("svgPath",e.imageSource)("fabricColor",e.selectedFabricColor),i(3),d(h(10,48,"hanging_pergola")),i(3),d(h(13,50,"dimensions")),i(5),P("",h(18,52,"width")," (cm)"),i(2),v("ngModel",e.width),c("min",e.minWidthValue)("max",e.maxWidthValue),i(2),m("Min: ",e.minWidthValue," cm, Max: ",e.maxWidthValue," cm"),i(3),P("",h(25,54,"projection")," (cm)"),i(2),v("ngModel",e.projection),c("min",e.minProjectionValue)("max",e.maxProjectionValue),i(2),m("Min: ",e.minProjectionValue," cm, Max: ",e.maxProjectionValue," cm"),i(),c("fabricColorsList",e.fabricColorsList)("selectedFabricColor",e.selectedFabricColor),i(),c("pergolaColorsList",e.pergolaColorsList)("selectedPergolaColor",e.selectedPergolaColor),i(2),d(h(33,56,"lights")),i(2),c("hideSingleSelectionIndicator",!0),i(),c("selected",e.selectedLightsType==="no")("selectable",e.selectedLightsType!=="no"),i(),P(" ",h(37,58,"no_lights")," "),i(2),c("selected",e.selectedLightsType==="standard")("selectable",e.selectedLightsType!=="standard"),i(),m(" ",h(40,60,"standard_lights")," (+",e.standardLightsPrice,"\u20AC) "),i(2),c("selected",e.selectedLightsType==="lux")("selectable",e.selectedLightsType!=="lux"),i(),m(" ",h(43,62,"lux_lights")," (+",e.luxLightsPrice,"\u20AC) "),i(3),d(h(46,64,"cover")),i(2),c("hideSingleSelectionIndicator",!0),i(),c("selected",!e.isCoverSelected)("selectable",e.isCoverSelected),i(),P(" ",h(50,66,"no_cover")," "),i(2),c("selected",e.isCoverSelected)("selectable",!e.isCoverSelected),i(),m(" ",h(53,68,"cover")," (+",e.coverPrice,"\u20AC) "),i(2),c("totalPriceWithTax",e.totalPriceWithTax)("totalPrice",e.totalPrice)("tax",e.tax))},dependencies:[O,D,N,H,w,E,W,F,B,I,k,R,M,V,G,q,A,z],styles:[".hanging-pergola[_ngcontent-%COMP%]{min-width:320px;margin-top:24px;min-height:90%}"]})};export{K as HangingPergolaComponent};

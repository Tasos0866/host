import{a as J}from"./chunk-57Z46VA2.js";import{a as E,b as W,c as B,d as X,e as Y,f as Z}from"./chunk-4Z4RIYRB.js";import"./chunk-Q7C7OCQL.js";import{a as I}from"./chunk-CDH7M54U.js";import{c as F,d as k,e as D,f as O,g as A,h as N,i as R,j as z,k as G,l as H,m as q,o as K,p as Q,q as U}from"./chunk-7HRNV44S.js";import{w as j}from"./chunk-CJA2TO4M.js";import{Ab as C,Bb as v,Cb as P,Db as S,Eb as b,Fa as i,Fb as T,Jb as p,Ka as _,Kb as c,Pb as L,Qa as w,_a as s,ea as h,fa as d,fb as r,gb as o,hb as f,lb as M,nb as g,qc as x,rb as y,zb as n}from"./chunk-W6CIVE6P.js";var $=class V{constructor(t,a,e,l){this.pergolaPricesService=t;this.changeDetector=a;this.snackBar=e;this.translate=l;this.pergolaPricesService.hasData()?(this.setMinMaxValues(),this.initializeDimensions(),this.initializeGeneralTable(),this.updatePrices()):this.pergolaPricesService.loadPricesFromSheet().subscribe(()=>{this.setMinMaxValues(),this.initializeDimensions(),this.initializeGeneralTable(),this.updatePrices()})}minWidthValue=0;maxWidthValue=0;minProjectionValue=0;maxProjectionValue=0;width=0;projection=0;pergolaColorsList=E;fabricColorsList=W;lightsEnabled=!1;parapetEnabled=!1;selectedLightsType="no";selectedParapetType="no";parapetPrice=null;coverPrice=null;standardLightsPrice=null;luxLightsPrice=null;pergolaPrice=null;totalPrice=null;totalPriceWithTax=null;isParapetSelected=!1;isCoverSelected=!1;isOtherPergolaColorSelected=!1;generalTable={};tax=null;aluminiumParapetPrice=null;metalParapetPrice=null;selectedPergolaColor="anthracite_7016";selectedFabricColor="#d5d4af";imageSource="assets/img/classic pergolas/anthracite_7016.svg";setMinMaxValues(){let t=["Pro100","Pro150","ProMEGA"];this.minWidthValue=Math.min(...t.map(a=>this.pergolaPricesService.getMinWidth(a))),this.maxWidthValue=Math.max(...t.map(a=>this.pergolaPricesService.getMaxWidth(a))),this.minProjectionValue=Math.min(...t.map(a=>this.pergolaPricesService.getMinProjection(a))),this.maxProjectionValue=Math.max(...t.map(a=>this.pergolaPricesService.getMaxProjection(a)))}initializeDimensions(){this.width=this.minWidthValue,this.projection=this.minProjectionValue}updatePrices(){this.updateParapetPrice(),this.updateCoverPrice(),this.updateStandardLightsPrice(),this.updateLuxLightsPrice(),this.updatePergolaPrice(),this.calculateTotalPrice()}updatePergolaPrice(){let a=["Pro100","Pro150","ProMEGA"].map(e=>this.pergolaPricesService.getPrice(e,this.projection,this.width)).filter(e=>e!==null);this.pergolaPrice=a.length>0?Math.min(...a):null,this.isOtherPergolaColorSelected&&this.pergolaPrice!==null&&(this.pergolaPrice=Math.floor(this.pergolaPrice*1.1))}updateParapetPrice(){this.updateMetalParapetPrice(),this.updateAluminiumParapetPrice(),this.selectedParapetType==="aluminium"?this.parapetPrice=this.aluminiumParapetPrice:this.selectedParapetType==="metal"?this.parapetPrice=this.metalParapetPrice:this.parapetPrice=0}updateAluminiumParapetPrice(){this.width&&this.projection&&(this.aluminiumParapetPrice=this.pergolaPricesService.getPrice("Parapet",this.width),this.isOtherPergolaColorSelected&&this.aluminiumParapetPrice!==null&&(this.aluminiumParapetPrice=Math.floor(this.aluminiumParapetPrice*1.1)),this.changeDetector.markForCheck())}updateMetalParapetPrice(){this.width>=this.minWidthValue&&this.width<=this.maxWidthValue?(this.metalParapetPrice=this.calculateMetalParapetPrice(),this.isOtherPergolaColorSelected&&this.metalParapetPrice!==null&&(this.metalParapetPrice=Math.floor(this.metalParapetPrice*1.1)),this.changeDetector.markForCheck()):this.metalParapetPrice=null}updateCoverPrice(){this.width&&this.projection&&(this.coverPrice=this.pergolaPricesService.getPrice("Cover",this.projection,this.width),this.isOtherPergolaColorSelected&&this.coverPrice!==null&&(this.coverPrice=Math.floor(this.coverPrice*1.1)),this.changeDetector.markForCheck())}calculateMetalParapetPrice(){if(!this.width)return null;let t=this.width/100,a=t*25,e=0;return t<5?e=25*5:t>=5&&t<=8.5?e=25*7.5:t>8.5&&t<=12.5?e=25*10:t>12.5&&(e=25*12.5),Math.floor(a+e)}updateStandardLightsPrice(){this.width&&this.projection&&(this.standardLightsPrice=this.pergolaPricesService.getPrice("Lights_Standard",this.projection,this.width),this.changeDetector.markForCheck())}updateLuxLightsPrice(){this.width&&this.projection&&(this.luxLightsPrice=this.pergolaPricesService.getPrice("Lights_Lux",this.projection,this.width),this.changeDetector.markForCheck())}valuesOutOfRange(){return this.width<this.minWidthValue||this.width>this.maxWidthValue||this.projection<this.minProjectionValue||this.projection>this.maxProjectionValue}calculateTotalPrice(){if(this.valuesOutOfRange()){this.totalPrice=null,this.totalPriceWithTax=null,this.tax=null;return}let t=this.isParapetSelected?this.parapetPrice??0:0,a=this.isCoverSelected?this.coverPrice??0:0,e=this.generalTable.VAT/100;this.totalPrice=(this.pergolaPrice??0)+t+a+(this.lightsEnabled?(this.selectedLightsType==="lux"?this.luxLightsPrice:this.standardLightsPrice)??0:0),this.tax=Math.floor(this.totalPrice*e),this.totalPriceWithTax=this.totalPrice+this.tax,this.changeDetector.markForCheck()}initializeGeneralTable(){this.generalTable=this.pergolaPricesService.getGeneralTable()}onLightsToggle(t){this.selectedLightsType=t,this.lightsEnabled=t!=="no",this.updatePrices()}onParapetToggle(t){this.isParapetSelected=t!=="no",this.selectedParapetType=t,this.updatePrices()}onBlur(t,a){let e=t.target;if(!e)return;let l=Number(e.value);a==="width"?(l<this.minWidthValue?e.value=String(this.minWidthValue):l>this.maxWidthValue&&(e.value=String(this.maxWidthValue)),this.width=Number(e.value)):a==="projection"&&(l<this.minProjectionValue?e.value=String(this.minProjectionValue):l>this.maxProjectionValue&&(e.value=String(this.maxProjectionValue)),this.projection=Number(e.value)),this.updatePrices()}onFabricColorChange(t){let a=this.fabricColorsList.find(e=>e.value===t.value);this.selectedFabricColor=a?.colorCode||"#d5d4af"}onPergolaColorChange(t){if(this.selectedPergolaColor=t.value,this.isOtherPergolaColorSelected=this.selectedPergolaColor==="other",this.imageSource=`assets/img/classic pergolas/${this.selectedPergolaColor}.svg`,this.isOtherPergolaColorSelected){let a=this.translate.instant("other_pergola_color_message"),e=this.translate.instant("close");this.snackBar.open(a,e,{duration:8e3})}this.updatePrices()}onCoverToggle(t){this.isCoverSelected=t==="yes",this.calculateTotalPrice()}static \u0275fac=function(a){return new(a||V)(_(I),_(L),_(Z),_(j))};static \u0275cmp=w({type:V,selectors:[["app-classic-pergola"]],decls:70,vars:94,consts:[["tooltip","matTooltip"],[1,"classic-pergola","product-container"],[1,"awning-title"],[1,"desktop-layout"],[1,"svg-width"],[3,"svgPath","fabricColor"],[1,"form-fields"],[1,"awning-title-desktop"],[1,"dimensions-title"],[1,"dimensions-fields"],["appearance","outline",1,"width-field"],["matInput","","type","number",3,"ngModelChange","blur","ngModel","min","max"],["appearance","outline"],[3,"fabricColorChange","fabricColorsList","selectedFabricColor"],[3,"pergolaColorChange","pergolaColorsList","selectedPergolaColor"],["aria-label","Front support selection","matTooltipPosition","above","matTooltipClass","tooltip",1,"field",3,"hideSingleSelectionIndicator","matTooltip"],[3,"selectionChange","selected","selectable"],["aria-label","Lights selection",1,"field",3,"hideSingleSelectionIndicator"],["aria-label","Cover selection",1,"field",3,"hideSingleSelectionIndicator"],[3,"totalPriceWithTax","totalPrice","tax"]],template:function(a,e){if(a&1){let l=M();r(0,"div",1)(1,"h1",2),n(2),p(3,"translate"),o(),r(4,"div",3)(5,"div",4),f(6,"app-svg-viewer",5),o(),r(7,"div",6)(8,"h1",7),n(9),p(10,"translate"),o(),r(11,"h4",8),n(12),p(13,"translate"),o(),r(14,"div",9)(15,"mat-form-field",10)(16,"mat-label"),n(17),p(18,"translate"),o(),r(19,"input",11),T("ngModelChange",function(u){return h(l),b(e.width,u)||(e.width=u),d(u)}),g("ngModelChange",function(){return h(l),d(e.updatePrices())})("blur",function(u){return h(l),d(e.onBlur(u,"width"))}),o(),r(20,"mat-hint"),n(21),o()(),r(22,"mat-form-field",12)(23,"mat-label"),n(24),p(25,"translate"),o(),r(26,"input",11),T("ngModelChange",function(u){return h(l),b(e.projection,u)||(e.projection=u),d(u)}),g("ngModelChange",function(){return h(l),d(e.updatePrices())})("blur",function(u){return h(l),d(e.onBlur(u,"projection"))}),o(),r(27,"mat-hint"),n(28),o()()(),r(29,"app-fabric-color-chips",13),g("fabricColorChange",function(u){return h(l),d(e.onFabricColorChange(u))}),o(),r(30,"app-pergola-color-chips",14),g("pergolaColorChange",function(u){return h(l),d(e.onPergolaColorChange(u))}),o(),r(31,"h4"),n(32),p(33,"translate"),o(),r(34,"mat-chip-listbox",15,0),p(36,"translate"),r(37,"mat-chip-option",16),g("selectionChange",function(){return h(l),d(e.onParapetToggle("no"))}),n(38),p(39,"translate"),o(),r(40,"mat-chip-option",16),g("selectionChange",function(){return h(l),d(e.onParapetToggle("aluminium"))}),n(41),p(42,"translate"),o(),r(43,"mat-chip-option",16),g("selectionChange",function(){return h(l),d(e.onParapetToggle("metal"))}),n(44),p(45,"translate"),o()(),r(46,"h4"),n(47),p(48,"translate"),o(),r(49,"mat-chip-listbox",17)(50,"mat-chip-option",16),g("selectionChange",function(){return h(l),d(e.onLightsToggle("no"))}),n(51),p(52,"translate"),o(),r(53,"mat-chip-option",16),g("selectionChange",function(){return h(l),d(e.onLightsToggle("standard"))}),n(54),p(55,"translate"),o(),r(56,"mat-chip-option",16),g("selectionChange",function(){return h(l),d(e.onLightsToggle("lux"))}),n(57),p(58,"translate"),o()(),r(59,"h4"),n(60),p(61,"translate"),o(),r(62,"mat-chip-listbox",18)(63,"mat-chip-option",16),g("selectionChange",function(){return h(l),d(e.onCoverToggle("no"))}),n(64),p(65,"translate"),o(),r(66,"mat-chip-option",16),g("selectionChange",function(){return h(l),d(e.onCoverToggle("yes"))}),n(67),p(68,"translate"),o()(),f(69,"app-total-price-card",19),o()()()}a&2&&(i(2),C(c(3,60,"classic_pergola")),i(4),s("svgPath",e.imageSource)("fabricColor",e.selectedFabricColor),i(3),C(c(10,62,"classic_pergola")),i(3),C(c(13,64,"dimensions")),i(5),v("",c(18,66,"width")," (cm)"),i(2),S("ngModel",e.width),s("min",e.minWidthValue)("max",e.maxWidthValue),i(2),P("Min: ",e.minWidthValue," cm, Max: ",e.maxWidthValue," cm"),i(3),v("",c(25,68,"projection")," (cm)"),i(2),S("ngModel",e.projection),s("min",e.minProjectionValue)("max",e.maxProjectionValue),i(2),P("Min: ",e.minProjectionValue," cm, Max: ",e.maxProjectionValue," cm"),i(),s("fabricColorsList",e.fabricColorsList)("selectedFabricColor",e.selectedFabricColor),i(),s("pergolaColorsList",e.pergolaColorsList)("selectedPergolaColor",e.selectedPergolaColor),i(2),C(c(33,70,"front_support")),i(2),y("matTooltip",c(36,72,"front_support_tooltip_text")),s("hideSingleSelectionIndicator",!0),i(3),s("selected",e.selectedParapetType==="no")("selectable",e.selectedParapetType!=="no"),i(),v(" ",c(39,74,"no_parapet")," "),i(2),s("selected",e.selectedParapetType==="aluminium")("selectable",e.selectedParapetType!=="aluminium"),i(),P(" ",c(42,76,"aluminium_parapet")," (+",e.aluminiumParapetPrice,"\u20AC) "),i(2),s("selected",e.selectedParapetType==="metal")("selectable",e.selectedParapetType!=="metal"),i(),P(" ",c(45,78,"metal_parapet")," (+",e.metalParapetPrice,"\u20AC) "),i(3),C(c(48,80,"lights")),i(2),s("hideSingleSelectionIndicator",!0),i(),s("selected",e.selectedLightsType==="no")("selectable",e.selectedLightsType!=="no"),i(),v(" ",c(52,82,"no_lights")," "),i(2),s("selected",e.selectedLightsType==="standard")("selectable",e.selectedLightsType!=="standard"),i(),P(" ",c(55,84,"standard_lights")," (+",e.standardLightsPrice,"\u20AC) "),i(2),s("selected",e.selectedLightsType==="lux")("selectable",e.selectedLightsType!=="lux"),i(),P(" ",c(58,86,"lux_lights")," (+",e.luxLightsPrice,"\u20AC) "),i(3),C(c(61,88,"cover")),i(2),s("hideSingleSelectionIndicator",!0),i(),s("selected",!e.isCoverSelected)("selectable",e.isCoverSelected),i(),v(" ",c(65,90,"no_cover")," "),i(2),s("selected",e.isCoverSelected)("selectable",!e.isCoverSelected),i(),P(" ",c(68,92,"cover")," (+",e.coverPrice,"\u20AC) "),i(2),s("totalPriceWithTax",e.totalPriceWithTax)("totalPrice",e.totalPrice)("tax",e.tax))},dependencies:[B,H,z,q,R,F,O,k,N,A,D,G,K,x,X,Y,U,Q,J],styles:[".classic-pergola[_ngcontent-%COMP%]{min-width:320px;margin-top:24px;min-height:90%}"]})};export{$ as ClassicPergolaComponent};
